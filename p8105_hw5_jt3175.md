Homework 5
================
Julia Thompson
11/5/2019

## Problem 1

``` r
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

There are two cases to address:

For numeric variables, you should fill in missing values with the mean
of non-missing values For character variables, you should fill in
missing values with “virginica” Write a function that takes a vector as
an argument; replaces missing values using the rules defined above; and
returns the resulting vector.

``` r
mean_sepal = mean(pull(iris_with_missing, Sepal.Length), na.rm=TRUE)

test_replace = tibble(replace_na(pull(iris_with_missing, Sepal.Length), mean_sepal))

rest2_replace = tibble(replace_na(pull(iris_with_missing, Species), "virginica"))
```

``` r
# Want a function that takes in 1 vector and outputs another vector with missing values replaced

replace_missing_fn = function(vector) {
  
  if(length(vector) == 1){
    stop("Argument cannot be computed for length 1 vectors")
  }
  
  else if(is.numeric(vector)) {
    mean = mean(vector, na.rm=TRUE)
    tibble(
      replace_na(vector, mean)
    )
  }
  
  else if (!is.numeric(vector)) {
    tibble(
      replace_na(vector, "virginica")
    )
  }
}

# Test the function

replace_missing_fn(pull(iris_with_missing, Sepal.Length))
```

    ## # A tibble: 150 x 1
    ##    `replace_na(vector, mean)`
    ##                         <dbl>
    ##  1                       5.1 
    ##  2                       4.9 
    ##  3                       4.7 
    ##  4                       4.6 
    ##  5                       5   
    ##  6                       5.4 
    ##  7                       5.82
    ##  8                       5   
    ##  9                       4.4 
    ## 10                       4.9 
    ## # ... with 140 more rows

``` r
# replace_missing_fn(2)

replace_missing_fn(pull(iris_with_missing, Species))
```

    ## # A tibble: 150 x 1
    ##    `replace_na(vector, "virginica")`
    ##    <chr>                            
    ##  1 setosa                           
    ##  2 setosa                           
    ##  3 setosa                           
    ##  4 setosa                           
    ##  5 setosa                           
    ##  6 setosa                           
    ##  7 setosa                           
    ##  8 setosa                           
    ##  9 setosa                           
    ## 10 setosa                           
    ## # ... with 140 more rows

Apply this function to the columns of iris\_with\_missing using a map
statement.

``` r
output = map(iris_with_missing, replace_missing_fn) %>% 
  bind_cols()
```
